# 融合平台视频服务 - 独立实例

## 概述

这是融合平台专用的视频生成服务实例，运行在端口 **18090**，与原始的9000端口服务完全独立。

## 架构说明

```
┌─────────────────────────────────┐
│   融合平台系统 (ronghe-platform) │
│                                  │
│  ┌──────────┐    ┌──────────┐   │
│  │ 前端     │───▶│ API网关  │   │
│  │ 18080    │    │ 18083    │   │
│  └──────────┘    └────┬─────┘   │
│                        │         │
│                        ▼         │
│                  ┌──────────┐   │
│                  │ 视频服务  │   │
│                  │ 18090    │   │
│                  └──────────┘   │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│   原始系统 (完全独立)             │
│                                  │
│  ┌──────────┐                    │
│  │ 视频服务  │                    │
│  │ 9000     │                    │
│  └──────────┘                    │
└─────────────────────────────────┘
```

## 端口配置

| 服务 | 端口 | 说明 |
|------|------|------|
| 融合平台前端 | 18080 | Vue.js开发服务器 |
| 融合平台API网关 | 18083 | Express API网关 |
| **融合平台视频服务** | **18090** | **融合平台专用，与9000完全独立** |
| 原始视频服务 | 9000 | 独立运行，不受融合平台影响 |

## 启动方式

### 方式1：使用启动脚本（推荐）

```bash
cd D:\projects\ronghe-platform
.\start-dev.bat
```

会自动启动：
- 前端服务 (18080)
- API网关 (18083)
- 融合平台视频服务 (18090)

### 方式2：手动启动

```bash
cd D:\projects\ronghe-platform\video-service
$env:FFMPEG_PATH='C:\ffmpeg\ffmpeg-8.0-essentials_build\bin\ffmpeg.exe'
python -u -B app.py
```

或使用提供的启动脚本：

```bash
cd D:\projects\ronghe-platform\video-service
.\start.bat
```

## 数据隔离

两个视频服务使用完全独立的数据目录：

- **融合平台视频服务 (18090)**:
  - 上传目录: `D:\projects\ronghe-platform\video-service\uploads\`
  - 输出目录: `D:\projects\ronghe-platform\video-service\output\`

- **原始视频服务 (9000)**:
  - 上传目录: `D:\projects\ffmpeg\web_app\uploads\`
  - 输出目录: `D:\projects\ffmpeg\web_app\output\`

## 功能说明

两个服务功能完全一样：
- ✅ 图片上传
- ✅ 视频生成
- ✅ 图片链接同步下载
- ✅ 所有API接口

但数据完全隔离，互不干扰。

## 停止服务

```bash
# 停止融合平台视频服务
Get-Process python | Where-Object { $_.Path -like "*ronghe-platform*" } | Stop-Process
```

## 故障排查

如果遇到端口冲突：
```bash
# 检查端口占用
netstat -ano | findstr :18090

# 终止占用进程
taskkill /PID <进程ID> /F
```

