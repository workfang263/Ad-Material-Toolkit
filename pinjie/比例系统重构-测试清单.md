# 比例系统重构 - 测试清单

**测试日期**：2025-12-24  
**测试版本**：比例系统重构完成版本  
**测试人员**：开发团队

---

## 📋 测试前准备

### 1. 启动服务
- [ ] 前端服务已启动（`npm run dev`）
- [ ] API 网关服务已启动（端口 18083）
- [ ] Python 图像处理服务已启动（端口 18091）

### 2. 打开页面
- [ ] 打开图片拼接页面
- [ ] 检查浏览器控制台是否有错误

---

## ✅ 测试项目

### 阶段1：基础功能测试

#### 1.1 页面加载测试
- [ ] 页面正常加载，无错误
- [ ] 画布显示正常（1:1 正方形）
- [ ] 默认尺寸显示正确：
  - 左侧主图：800 × 1200
  - 右上细节：400 × 600
  - 右下细节：400 × 600
  - 画布总尺寸：1200 × 1200

#### 1.2 素材添加测试
- [ ] 可以添加图片 URL
- [ ] 图片下载成功
- [ ] 素材列表显示正常

#### 1.3 拖拽素材到槽位
- [ ] 可以拖拽素材到左侧槽位
- [ ] 可以拖拽素材到右上槽位
- [ ] 可以拖拽素材到右下槽位
- [ ] 图片显示正常

---

### 阶段2：拖动分割线测试（使用比例系统）

#### 2.1 纵向拖动测试（调整左右宽度）
- [ ] 可以拖动纵向分割线（左侧和右侧之间的竖线）
- [ ] 拖动时，左侧和右侧宽度实时更新
- [ ] 拖动到接近 50% 时，自动吸附到 50%
- [ ] 鼠标移出画布后，仍能继续拖动
- [ ] 拖动结束后，画布仍然是 1:1 正方形
- [ ] 控制台日志显示正确的 splitX 值

**测试步骤：**
1. 拖动纵向分割线向左移动
2. 观察左侧宽度是否增加，右侧宽度是否减少
3. 拖动到接近中间位置（50%），观察是否自动吸附
4. 拖动到最左和最右，观察是否有边界限制（最小 100px）

#### 2.2 横向拖动测试（调整右上右下高度）
- [ ] 可以拖动横向分割线（右上和右下之间的横线）
- [ ] 拖动时，右上和右下高度实时更新
- [ ] 拖动到接近 50% 时，自动吸附到 50%
- [ ] 鼠标移出画布后，仍能继续拖动
- [ ] 拖动结束后，画布仍然是 1:1 正方形
- [ ] 控制台日志显示正确的 splitY 值

**测试步骤：**
1. 拖动横向分割线向上移动
2. 观察右上高度是否增加，右下高度是否减少
3. 拖动到接近中间位置（50%），观察是否自动吸附
4. 拖动到最上和最下，观察是否有边界限制（最小 100px）

---

### 阶段3：输入框联动测试（使用比例系统）

#### 3.1 左侧宽度输入框测试
- [ ] 修改左侧宽度输入框，值正确更新
- [ ] 右侧宽度自动更新（软性联动）
- [ ] 输入框显示"自动计算（右侧宽度）"提示
- [ ] 右侧宽度输入框已禁用
- [ ] 控制台日志显示正确的 splitX 值

**测试步骤：**
1. 修改左侧宽度为 600
2. 观察右侧宽度是否自动计算为 600（如果画布总尺寸是 1200）
3. 修改左侧宽度为 1000
4. 观察右侧宽度是否自动计算为 200

#### 3.2 左侧高度输入框测试
- [ ] 修改左侧高度输入框，值正确更新
- [ ] 实际更新的是画布总尺寸（等比例缩放）
- [ ] 所有区域按比例缩放
- [ ] 控制台日志显示正确的 canvasSize 值

**测试步骤：**
1. 修改左侧高度为 1000
2. 观察画布总尺寸是否更新为 1000
3. 观察所有区域是否按比例缩放

#### 3.3 右上高度输入框测试
- [ ] 修改右上高度输入框，值正确更新
- [ ] 右下高度自动更新（软性联动）
- [ ] 输入框显示"自动计算（右下高度）"提示
- [ ] 右下高度输入框已禁用
- [ ] 控制台日志显示正确的 splitY 值

**测试步骤：**
1. 修改右上高度为 400
2. 观察右下高度是否自动计算为 800（如果画布总尺寸是 1200）
3. 修改右上高度为 800
4. 观察右下高度是否自动计算为 400

#### 3.4 画布总尺寸输入框测试
- [ ] 修改画布总尺寸输入框，值正确更新
- [ ] 所有区域等比例缩放（splitX 和 splitY 保持不变）
- [ ] 画布仍然是 1:1 正方形
- [ ] 控制台日志显示正确的 canvasSize 值

**测试步骤：**
1. 修改画布总尺寸为 1000
2. 观察所有区域是否按比例缩放
3. 观察左侧宽度、右上高度等是否按比例变化
4. 观察画布是否仍然是 1:1 正方形

---

### 阶段4：布局方式测试（绝对定位 + aspect-ratio）

#### 4.1 画布 1:1 测试
- [ ] 画布始终是 1:1 正方形（使用 `aspect-ratio: 1/1`）
- [ ] 无论如何调整，画布宽度 = 高度
- [ ] 画布尺寸等于 `canvasSize`

#### 4.2 绝对定位测试
- [ ] 左侧槽位使用绝对定位，位置和尺寸正确
- [ ] 右上槽位使用绝对定位，位置和尺寸正确
- [ ] 右下槽位使用绝对定位，位置和尺寸正确
- [ ] 槽位之间没有重叠
- [ ] 槽位位置随拖动和输入框修改实时更新

#### 4.3 分割线位置测试
- [ ] 纵向分割线位置正确（位于左侧和右侧分界处）
- [ ] 横向分割线位置正确（位于右上和右下分界处）
- [ ] 分割线位置随拖动实时更新

---

### 阶段5：综合测试

#### 5.1 拖动 + 输入框联动测试
- [ ] 拖动分割线后，输入框值自动更新
- [ ] 修改输入框后，分割线位置自动更新
- [ ] 两者联动正常，无冲突

#### 5.2 重置功能测试
- [ ] 点击"重置"按钮，所有尺寸恢复默认值
- [ ] 默认值正确：
  - 左侧：800 × 1200
  - 右上：400 × 600
  - 右下：400 × 600
  - 画布：1200 × 1200

#### 5.3 生成图片测试
- [ ] 填充所有三个槽位
- [ ] 点击"立即生成"按钮
- [ ] 图片生成成功
- [ ] 生成的图片尺寸正确（1:1 正方形）
- [ ] 生成的图片布局正确

---

## 🐛 已知问题

（测试过程中发现的问题记录在这里）

---

## ✅ 测试结果

### 测试通过项
- [ ] 所有测试项均通过

### 测试失败项
- [ ] 无

### 需要修复的问题
- [ ] 无

---

## 📝 测试备注

（测试过程中的其他发现和备注）

---

**测试完成时间**：________  
**测试人员签名**：________


