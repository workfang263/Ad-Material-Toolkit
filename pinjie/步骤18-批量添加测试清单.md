# 步骤18：批量添加素材 - 测试清单

## 测试日期：2025-12-24

## 测试环境
- 前端服务：http://localhost:18080/image-stitch
- API 网关：http://localhost:18083
- Python 服务：http://localhost:18091

---

## 测试场景

### 场景1：正常批量添加（用逗号分隔）✅

**测试数据：**
```
https://picsum.photos/800/600?random=1, https://picsum.photos/800/600?random=2, https://picsum.photos/800/600?random=3
```

**测试步骤：**
1. [ ] 在多行文本域中输入上述URL
2. [ ] 点击"批量添加"按钮
3. [ ] 观察进度显示（1/3、2/3、3/3）
4. [ ] 验证素材列表显示3个图片
5. [ ] 验证成功提示："批量添加成功！共添加 3 个素材"

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景2：用换行分隔 ✅

**测试数据：**
```
https://picsum.photos/800/600?random=4
https://picsum.photos/800/600?random=5
https://picsum.photos/800/600?random=6
```

**测试步骤：**
1. [ ] 清空输入框和素材列表
2. [ ] 在多行文本域中输入上述URL（每行一个）
3. [ ] 点击"批量添加"按钮
4. [ ] 验证成功添加3个素材

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景3：混合分隔符（逗号+换行+分号）✅

**测试数据：**
```
https://picsum.photos/800/600?random=7, https://picsum.photos/800/600?random=8
https://picsum.photos/800/600?random=9; https://picsum.photos/800/600?random=10
```

**测试步骤：**
1. [ ] 清空输入框和素材列表
2. [ ] 输入上述URL（混合使用逗号、换行、分号）
3. [ ] 点击"批量添加"按钮
4. [ ] 验证成功添加4个素材

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景4：包含无效URL ✅

**测试数据：**
```
https://picsum.photos/800/600?random=11
invalid-url-test
https://picsum.photos/800/600?random=12
```

**测试步骤：**
1. [ ] 清空输入框和素材列表
2. [ ] 输入上述URL（包含一个无效URL）
3. [ ] 点击"批量添加"按钮
4. [ ] 验证提示"发现 1 个无效URL，已自动过滤"
5. [ ] 验证只添加2个有效素材

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景5：重复URL（去重）✅

**测试数据：**
```
https://picsum.photos/800/600?random=13
https://picsum.photos/800/600?random=13
https://picsum.photos/800/600?random=14
https://picsum.photos/800/600?random=14
https://picsum.photos/800/600?random=15
```

**测试步骤：**
1. [ ] 清空输入框和素材列表
2. [ ] 输入上述URL（包含重复）
3. [ ] 点击"批量添加"按钮
4. [ ] 验证只添加3个素材（自动去重）

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景6：已添加的URL（过滤）✅

**测试步骤：**
1. [ ] 清空素材列表
2. [ ] 先批量添加：
```
https://picsum.photos/800/600?random=16
https://picsum.photos/800/600?random=17
```
3. [ ] 再次批量添加：
```
https://picsum.photos/800/600?random=16
https://picsum.photos/800/600?random=18
```
4. [ ] 验证提示"已过滤 1 个重复的URL"
5. [ ] 验证只新增1个素材（random=18）
6. [ ] 验证总共有3个素材

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景7：并发控制（测试5个以上URL）✅

**测试数据：**
```
https://picsum.photos/800/600?random=20
https://picsum.photos/800/600?random=21
https://picsum.photos/800/600?random=22
https://picsum.photos/800/600?random=23
https://picsum.photos/800/600?random=24
https://picsum.photos/800/600?random=25
https://picsum.photos/800/600?random=26
https://picsum.photos/800/600?random=27
```

**测试步骤：**
1. [ ] 清空素材列表
2. [ ] 打开浏览器开发者工具 → Network 面板
3. [ ] 输入上述8个URL
4. [ ] 点击"批量添加"按钮
5. [ ] 观察Network面板：同时最多3个请求在进行
6. [ ] 观察进度：1/8、2/8、3/8...8/8
7. [ ] 验证所有8个素材都添加成功

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景8：空输入处理 ✅

**测试步骤：**
1. [ ] 清空输入框
2. [ ] 点击"批量添加"按钮
3. [ ] 验证提示"请输入图片 URL"

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景9：只有空格和换行 ✅

**测试数据：**
```
   
   
   
```

**测试步骤：**
1. [ ] 输入只包含空格和换行的文本
2. [ ] 点击"批量添加"按钮
3. [ ] 验证提示"未识别到有效的图片 URL"

**测试结果：** □ 通过  □ 失败  
**备注：**

---

### 场景10：批量下载中禁用输入 ✅

**测试步骤：**
1. [ ] 输入5个以上URL
2. [ ] 点击"批量添加"按钮
3. [ ] 在下载过程中：
   - [ ] 验证输入框被禁用
   - [ ] 验证"批量添加"按钮被禁用
   - [ ] 验证按钮文字变为"批量下载中..."
4. [ ] 等待下载完成，验证输入框恢复可用

**测试结果：** □ 通过  □ 失败  
**备注：**

---

## 测试总结

### 总体测试结果
- 通过：___ / 10
- 失败：___ / 10
- 通过率：___%

### 发现的问题
1. 
2. 
3. 

### 性能观察
- 3个并发下载速度：____
- 10个URL总耗时：____
- 重试机制是否正常：____

### 改进建议
1. 
2. 
3. 

### 测试人员：__________
### 测试日期：__________

---

## 附：测试用的图片URL

使用 picsum.photos 提供的随机图片服务：
- `https://picsum.photos/800/600?random=1` (每个数字都是不同的图片)
- `https://picsum.photos/800/600?random=2`
- 依此类推...

注意：这些URL可能需要网络连接才能访问。


